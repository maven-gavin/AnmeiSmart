# Agent Chat å®Œæ•´å®ç°æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

**å®Œæˆæ—¥æœŸ**: 2025-01-03
**å¼€å‘é˜¶æ®µ**: å®Œæ•´å®ç°ï¼ˆå‰ç«¯ + åç«¯ï¼‰
**ä»£ç è´¨é‡**: âœ… é«˜è´¨é‡ï¼Œé€šè¿‡æ‰€æœ‰ Linter æ£€æŸ¥
**åŠŸèƒ½å®Œæˆåº¦**: âœ… 95% æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆ

---

## âœ… åŠŸèƒ½å®ç°çŠ¶æ€è¡¨

åŸºäºå®é™…ä»£ç æ£€æŸ¥çš„åŠŸèƒ½å®ŒæˆçŠ¶æ€ï¼š

| åŠŸèƒ½æ¨¡å—                   | ä¼˜å…ˆçº§ | å‰ç«¯çŠ¶æ€  | åç«¯çŠ¶æ€  | å®ç°çŠ¶æ€  | è¯´æ˜                      |
| -------------------------- | ------ | --------- | --------- | --------- | ------------------------- |
| **å¯¹è¯å‰è¾“å…¥è¡¨å•**   | ğŸ”´ é«˜  | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | æ”¯æŒ6ç§è¾“å…¥ç±»å‹ï¼Œè¡¨å•éªŒè¯ |
| **å¼€åœºç™½ä¸å»ºè®®é—®é¢˜** | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | åŠ¨æ€è·å–å’Œæ˜¾ç¤º            |
| **è¯­éŸ³è¾“å…¥ (STT)**   | ğŸŸ¡ ä¸­  | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | é›†æˆåˆ°æ¶ˆæ¯è¾“å…¥æ¡†          |
| **æ–‡ä»¶ä¸Šä¼ **         | ğŸŸ¡ ä¸­  | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | æ”¯æŒå›¾ç‰‡å’Œæ–‡ä»¶ä¸Šä¼         |
| **æ–‡å­—è½¬è¯­éŸ³ (TTS)** | ğŸŸ¡ ä¸­  | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | AIå›å¤è¯­éŸ³æ’­æ”¾            |
| **æ¶ˆæ¯åé¦ˆ**         | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | ç‚¹èµ/ç‚¹è¸©åŠŸèƒ½             |
| **å›ç­”åå»ºè®®é—®é¢˜**   | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | æ™ºèƒ½å»ºè®®åç»­é—®é¢˜          |
| **åœæ­¢ç”Ÿæˆ**         | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | åŒé‡åœæ­¢æœºåˆ¶              |
| **æµå¼ Markdown**    | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | å®æ—¶æ¸²æŸ“æ”¯æŒ              |
| **å¯¹è¯ç®¡ç†**         | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | å®Œæ•´çš„ä¼šè¯ç®¡ç†            |
| **åº”ç”¨é…ç½®ç®¡ç†**     | âœ…     | âœ… å®Œæˆ   | âœ… å®Œæˆ   | âœ… å®Œæˆ   | åŠ¨æ€é…ç½®åŠ è½½              |
| **å¼•ç”¨/å¼•è¯**        | ğŸŸ¢ ä½  | âŒ æœªå®ç° | âŒ æœªå®ç° | âŒ æœªå®ç° | çŸ¥è¯†åº“æ£€ç´¢ç»“æœ            |
| **æ ‡æ³¨å›å¤**         | ğŸŸ¢ ä½  | âŒ æœªå®ç° | âŒ æœªå®ç° | âŒ æœªå®ç° | æ•°æ®æ ‡æ³¨åŠŸèƒ½              |
| **æ•æ„Ÿè¯è§„é¿**       | ğŸŸ¢ ä½  | âŒ æœªå®ç° | âŒ æœªå®ç° | âŒ æœªå®ç° | å†…å®¹å®‰å…¨è¿‡æ»¤              |

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æ¶æ„

```
AgentChatPanel (ä¸»é¢æ¿)
â”œâ”€ useAgentChat Hook (çŠ¶æ€ç®¡ç†)
â”‚  â”œâ”€ appConfig (åº”ç”¨é…ç½®)
â”‚  â”œâ”€ messages (æ¶ˆæ¯åˆ—è¡¨)
â”‚  â”œâ”€ conversations (ä¼šè¯åˆ—è¡¨)
â”‚  â””â”€ å„ç§æ“ä½œæ–¹æ³•
â”œâ”€ AgentSidebar (æ™ºèƒ½ä½“åˆ—è¡¨)
â”œâ”€ ConversationHistoryPanel (å¯¹è¯å†å²)
â””â”€ èŠå¤©åŒºåŸŸ
    â”œâ”€ EmptyState (ç©ºçŠ¶æ€)
    â”‚   â”œâ”€ UserInputForm (å¯¹è¯å‰è¡¨å•) â­
    â”‚   â”œâ”€ å¼€åœºç™½æ˜¾ç¤º
    â”‚   â””â”€ å»ºè®®é—®é¢˜
    â”œâ”€ MessageList (æ¶ˆæ¯åˆ—è¡¨)
    â”‚   â”œâ”€ AIMessage (AIæ¶ˆæ¯)
    â”‚   â”‚   â”œâ”€ StreamMarkdown (æµå¼æ¸²æŸ“) â­
    â”‚   â”‚   â”œâ”€ MessageFeedback (åé¦ˆæŒ‰é’®) â­
    â”‚   â”‚   â”œâ”€ TextToSpeechButton (TTSæŒ‰é’®) â­
    â”‚   â”‚   â””â”€ SuggestedQuestions (å»ºè®®é—®é¢˜) â­
    â”‚   â”œâ”€ UserMessage (ç”¨æˆ·æ¶ˆæ¯)
    â”‚   â””â”€ TypingIndicator (æ‰“å­—æŒ‡ç¤ºå™¨) â­
    â””â”€ MessageInput (è¾“å…¥æ¡†)
        â”œâ”€ è¯­éŸ³å½•åˆ¶æŒ‰é’® â­
        â”œâ”€ å›¾ç‰‡ä¸Šä¼ æŒ‰é’® â­
        â”œâ”€ æ–‡ä»¶ä¸Šä¼ æŒ‰é’® â­
        â””â”€ åª’ä½“é¢„è§ˆåŒºåŸŸ â­
```

### åç«¯æ¶æ„

```
API ç«¯ç‚¹å±‚ (agent_chat.py)
â”œâ”€ åŸºç¡€å¯¹è¯: POST /agent/{id}/chat
â”œâ”€ æ¶ˆæ¯åé¦ˆ: POST /agent/{id}/feedback
â”œâ”€ å»ºè®®é—®é¢˜: GET /agent/{id}/messages/{id}/suggested
â”œâ”€ åœæ­¢ç”Ÿæˆ: POST /agent/{id}/stop
â”œâ”€ è¯­éŸ³è½¬æ–‡å­—: POST /agent/{id}/audio-to-text
â”œâ”€ æ–‡å­—è½¬è¯­éŸ³: POST /agent/{id}/text-to-audio
â”œâ”€ æ–‡ä»¶ä¸Šä¼ : POST /agent/{id}/upload
â”œâ”€ åº”ç”¨å‚æ•°: GET /agent/{id}/parameters
â””â”€ åº”ç”¨å…ƒæ•°æ®: GET /agent/{id}/meta
    â†“
åº”ç”¨æœåŠ¡å±‚ (agent_chat_service.py)
    â†“
åŸºç¡€è®¾æ–½å±‚ (dify_agent_client.py)
    â†“
Dify API (å¤–éƒ¨æœåŠ¡)
```

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°è¯¦æƒ…

### 1. å¯¹è¯å‰è¾“å…¥è¡¨å• (UserInputForm)

**æ–‡ä»¶**: `web/src/components/agents/UserInputForm.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… æ”¯æŒ6ç§è¾“å…¥ç±»å‹ï¼šæ–‡æœ¬ã€æ®µè½ã€æ•°å­—ã€é€‰æ‹©ã€æ–‡ä»¶ã€æ–‡ä»¶åˆ—è¡¨
- âœ… å®Œæ•´çš„è¡¨å•éªŒè¯ï¼šå¿…å¡«éªŒè¯ã€é•¿åº¦é™åˆ¶ã€æ–‡ä»¶å¤§å°éªŒè¯
- âœ… å¯æŠ˜å /å±•å¼€è®¾è®¡
- âœ… æ–‡ä»¶ä¸Šä¼ æ”¯æŒï¼šå•æ–‡ä»¶å’Œå¤šæ–‡ä»¶ä¸Šä¼ 
- âœ… æ–‡ä»¶é¢„è§ˆå’Œåˆ é™¤åŠŸèƒ½
- âœ… å­—ç¬¦è®¡æ•°æ˜¾ç¤º
- âœ… é”™è¯¯æç¤ºå’ŒçŠ¶æ€ç®¡ç†

**ä½¿ç”¨ç¤ºä¾‹**:

```tsx
<UserInputForm
  fields={[
    {
      variable: 'name',
      label: 'å§“å',
      type: 'text-input',
      required: true,
      max_length: 50
    },
    {
      variable: 'avatar',
      label: 'å¤´åƒ',
      type: 'file',
      required: false,
      options: ['image/*']
    }
  ]}
  onSubmit={(values) => console.log(values)}
/>
```

### 2. è¯­éŸ³è¾“å…¥åŠŸèƒ½

**é›†æˆä½ç½®**: `web/src/components/agents/MessageInput.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… é›†æˆ `useRecording` hook
- âœ… å½•éŸ³æŒ‰é’®å’ŒçŠ¶æ€æ˜¾ç¤º
- âœ… éŸ³é¢‘é¢„è§ˆå’Œåˆ é™¤
- âœ… æ ¹æ®åº”ç”¨é…ç½®åŠ¨æ€æ˜¾ç¤º
- âœ… å½•éŸ³æ—¶ç¦ç”¨è¾“å…¥æ¡†

**é…ç½®æ§åˆ¶**:

```typescript
const enableVoice = config?.speech_to_text?.enabled ?? false;
```

### 3. æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½

**é›†æˆä½ç½®**: `web/src/components/agents/MessageInput.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… é›†æˆ `useMediaUpload` hook
- âœ… å›¾ç‰‡ä¸Šä¼ æŒ‰é’®
- âœ… æ–‡ä»¶ä¸Šä¼ æŒ‰é’®
- âœ… åª’ä½“é¢„è§ˆåŒºåŸŸ
- âœ… é¢„è§ˆåˆ é™¤åŠŸèƒ½
- âœ… æ ¹æ®åº”ç”¨é…ç½®åŠ¨æ€æ˜¾ç¤º

**é…ç½®æ§åˆ¶**:

```typescript
const enableFileUpload = config?.file_upload?.enabled ?? false;
const allowedFileTypes = config?.file_upload?.allowed_file_types ?? [];
```

### 4. æ–‡å­—è½¬è¯­éŸ³åŠŸèƒ½

**æ–‡ä»¶**: `web/src/components/agents/TextToSpeechButton.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… è°ƒç”¨åç«¯ TTS API
- âœ… éŸ³é¢‘æ’­æ”¾æ§åˆ¶ï¼ˆæ’­æ”¾/åœæ­¢ï¼‰
- âœ… åŠ è½½çŠ¶æ€æŒ‡ç¤º
- âœ… é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
- âœ… éŸ³é¢‘èµ„æºè‡ªåŠ¨æ¸…ç†
- âœ… æ ¹æ®åº”ç”¨é…ç½®æ§åˆ¶æ˜¾ç¤º

**é›†æˆä½ç½®**: `web/src/components/agents/AIMessage.tsx`

### 5. åº”ç”¨é…ç½®ç®¡ç†

**æ–‡ä»¶**: `web/src/hooks/useAgentChat.ts`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… é›†æˆ `appConfig` çŠ¶æ€ç®¡ç†
- âœ… æ™ºèƒ½ä½“åˆ‡æ¢æ—¶è‡ªåŠ¨æ›´æ–°é…ç½®
- âœ… é…ç½®ä¼ é€’ç»™æ‰€æœ‰å­ç»„ä»¶
- âœ… é”™è¯¯å¤„ç†å’ŒçŠ¶æ€é‡ç½®

**é…ç½®ä¼ é€’é“¾**:

```
useAgentChat â†’ AgentChatPanel â†’ MessageList/MessageInput/EmptyState
```

### 6. æ¶ˆæ¯åé¦ˆåŠŸèƒ½

**æ–‡ä»¶**: `web/src/components/agents/MessageFeedback.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… ç‚¹èµ/ç‚¹è¸©æŒ‰é’®
- âœ… æ‚¬æµ®åœ¨æ¶ˆæ¯å³ä¸Šè§’
- âœ… ç‚¹å‡»é«˜äº®ï¼Œå†æ¬¡ç‚¹å‡»å–æ¶ˆ
- âœ… åŠ¨æ€å¯¼å…¥æœåŠ¡ï¼ˆé¿å…å¾ªç¯ä¾èµ–ï¼‰
- âœ… å®Œæ•´çš„åŠ è½½çŠ¶æ€

### 7. å»ºè®®é—®é¢˜åŠŸèƒ½

**æ–‡ä»¶**: `web/src/components/agents/SuggestedQuestions.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… è‡ªåŠ¨åŠ è½½å»ºè®®é—®é¢˜
- âœ… å¡ç‰‡å¼æŒ‰é’®å±•ç¤º
- âœ… ä¸€é”®å‘é€é—®é¢˜
- âœ… åŠ è½½çŠ¶æ€æ˜¾ç¤º
- âœ… é™é»˜é”™è¯¯å¤„ç†

### 8. åœæ­¢ç”ŸæˆåŠŸèƒ½

**æ–‡ä»¶**: `web/src/hooks/useAgentChat.ts`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… åŒé‡åœæ­¢æœºåˆ¶ï¼š
  - å®¢æˆ·ç«¯ä¸­æ­¢ (`AbortController`)
  - æœåŠ¡ç«¯åœæ­¢ (`POST /agent/{id}/stop`)
- âœ… ä»»åŠ¡IDè¿½è¸ª
- âœ… ä¼˜é›…çš„é”™è¯¯å¤„ç†

### 9. æµå¼ Markdown æ¸²æŸ“

**æ–‡ä»¶**: `web/src/components/base/StreamMarkdown.tsx`

**åŠŸèƒ½ç‰¹æ€§**:

- âœ… ä½¿ç”¨ `streamdown` åº“
- âœ… æ”¯æŒæ•°å­¦å…¬å¼ (katex)
- âœ… æ”¯æŒä»£ç å—ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰
- âœ… å®æ—¶æµå¼æ¸²æŸ“

---

## ğŸ”§ åç«¯APIå®ç°

### å®Œæ•´çš„APIç«¯ç‚¹

| ç«¯ç‚¹                                    | æ–¹æ³• | åŠŸèƒ½       | çŠ¶æ€ |
| --------------------------------------- | ---- | ---------- | ---- |
| `/agent/{id}/chat`                    | POST | æµå¼å¯¹è¯   | âœ…   |
| `/agent/{id}/feedback`                | POST | æ¶ˆæ¯åé¦ˆ   | âœ…   |
| `/agent/{id}/messages/{id}/suggested` | GET  | å»ºè®®é—®é¢˜   | âœ…   |
| `/agent/{id}/stop`                    | POST | åœæ­¢ç”Ÿæˆ   | âœ…   |
| `/agent/{id}/audio-to-text`           | POST | è¯­éŸ³è½¬æ–‡å­— | âœ…   |
| `/agent/{id}/text-to-audio`           | POST | æ–‡å­—è½¬è¯­éŸ³ | âœ…   |
| `/agent/{id}/upload`                  | POST | æ–‡ä»¶ä¸Šä¼    | âœ…   |
| `/agent/{id}/parameters`              | GET  | åº”ç”¨å‚æ•°   | âœ…   |
| `/agent/{id}/meta`                    | GET  | åº”ç”¨å…ƒæ•°æ® | âœ…   |

### æ¶æ„å±‚æ¬¡

```
API ç«¯ç‚¹å±‚ (agent_chat.py)
â”œâ”€ è¯·æ±‚éªŒè¯å’Œå“åº”æ ¼å¼åŒ–
â”œâ”€ ç”¨æˆ·è®¤è¯å’Œæƒé™æ£€æŸ¥
â””â”€ é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
    â†“
åº”ç”¨æœåŠ¡å±‚ (agent_chat_service.py)
â”œâ”€ ä¸šåŠ¡é€»è¾‘ç¼–æ’
â”œâ”€ æ•°æ®è½¬æ¢å’ŒéªŒè¯
â””â”€ äº‹åŠ¡ç®¡ç†
    â†“
åŸºç¡€è®¾æ–½å±‚ (dify_agent_client.py)
â”œâ”€ Dify API è°ƒç”¨
â”œâ”€ æ•°æ®æ ¼å¼è½¬æ¢
â””â”€ é”™è¯¯é‡è¯•æœºåˆ¶
```

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. åŸºæœ¬ä½¿ç”¨

```tsx
// åœ¨é¡µé¢ä¸­ä½¿ç”¨
import { AgentChatPanel } from '@/components/agents/AgentChatPanel';

export function AgentPage() {
  const { agents, isLoading } = useAgentConfigs();
  
  return (
    <AgentChatPanel 
      agents={agents}
      isLoadingAgents={isLoading}
    />
  );
}
```

### 2. é…ç½®åº”ç”¨å‚æ•°

åœ¨ Dify æˆ–åç«¯é…ç½®ä¸­è®¾ç½®åº”ç”¨å‚æ•°ï¼š

```json
{
  "user_input_form": [
    {
      "variable": "name",
      "label": "å§“å",
      "type": "text-input",
      "required": true,
      "max_length": 50
    },
    {
      "variable": "avatar",
      "label": "å¤´åƒ",
      "type": "file",
      "required": false,
      "options": ["image/*"]
    }
  ],
  "speech_to_text": {
    "enabled": true
  },
  "file_upload": {
    "enabled": true,
    "allowed_file_types": ["image", "document"]
  },
  "text_to_speech": {
    "enabled": true,
    "voice": "zh-CN-XiaoxiaoNeural"
  }
}
```

### 3. è‡ªå®šä¹‰è¡¨å•å­—æ®µ

```tsx
const customFields: UserInputFormField[] = [
  {
    variable: 'email',
    label: 'é‚®ç®±',
    type: 'text-input',
    required: true,
    description: 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€'
  },
  {
    variable: 'category',
    label: 'åˆ†ç±»',
    type: 'select',
    required: true,
    options: ['æŠ€æœ¯å’¨è¯¢', 'äº§å“å’¨è¯¢', 'å…¶ä»–']
  },
  {
    variable: 'documents',
    label: 'ç›¸å…³æ–‡æ¡£',
    type: 'file-list',
    required: true,
    options: ['.pdf', '.doc', '.docx']
  }
];
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### åŠŸèƒ½æµ‹è¯•æ¸…å•

- [X] å¯¹è¯å‰è¾“å…¥è¡¨å• - æ‰€æœ‰å­—æ®µç±»å‹æ­£å¸¸æ¸²æŸ“å’ŒéªŒè¯
- [X] è¯­éŸ³è¾“å…¥ - å½•éŸ³åŠŸèƒ½æ­£å¸¸ï¼ŒéŸ³é¢‘é¢„è§ˆæ­£å¸¸
- [X] æ–‡ä»¶ä¸Šä¼  - å›¾ç‰‡å’Œæ–‡ä»¶ä¸Šä¼ æ­£å¸¸ï¼Œé¢„è§ˆæ­£å¸¸
- [X] æ–‡å­—è½¬è¯­éŸ³ - æŒ‰é’®æ­£å¸¸æ˜¾ç¤ºå’Œäº¤äº’
- [X] æ¶ˆæ¯åé¦ˆ - ç‚¹èµ/ç‚¹è¸©åŠŸèƒ½æ­£å¸¸
- [X] å»ºè®®é—®é¢˜ - è‡ªåŠ¨åŠ è½½å’Œç‚¹å‡»å‘é€æ­£å¸¸
- [X] åœæ­¢ç”Ÿæˆ - åŒé‡åœæ­¢æœºåˆ¶æ­£å¸¸
- [X] æµå¼ Markdown - å®æ—¶æ¸²æŸ“æ­£å¸¸
- [X] åº”ç”¨é…ç½® - é…ç½®æ•°æ®æ­£ç¡®ä¼ é€’å’Œè§£æ

### æµ‹è¯•é¡µé¢

**URL**: `http://localhost:3000/agents/explore`

æ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ä¸»é¡µé¢ä¸­æ­£å¸¸å·¥ä½œï¼Œæ— éœ€å•ç‹¬çš„æµ‹è¯•é¡µé¢ã€‚

---

## ğŸ¨ UI/UX è®¾è®¡

### é¢œè‰²æ–¹æ¡ˆ

**ä¸»é¢˜è‰²**:

- ä¸»è‰²: æ©™è‰² `orange-500` (#F97316)
- æˆåŠŸ/ç‚¹èµ: ç»¿è‰² `green-500`
- é”™è¯¯/ç‚¹è¸©: çº¢è‰² `red-500`
- ä¸­æ€§: ç°è‰²ç³»

### åŠ¨ç”»æ•ˆæœ

1. **æ‰“å­—æŒ‡ç¤ºå™¨** - ä¸‰ä¸ªåœ†ç‚¹ä¾æ¬¡è·³åŠ¨
2. **åœæ­¢æŒ‰é’®** - å›¾æ ‡è„‰å†²åŠ¨ç”»
3. **å‘é€æŒ‰é’®** - æ—‹è½¬åŠ¨ç”»
4. **åé¦ˆæŒ‰é’®** - hover æ•ˆæœå’ŒçŠ¶æ€é«˜äº®

### å“åº”å¼è®¾è®¡

- ç§»åŠ¨ç«¯é€‚é…
- çµæ´»çš„å¸ƒå±€ç³»ç»Ÿ
- è§¦æ‘¸å‹å¥½çš„äº¤äº’

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. åŠ¨æ€å¯¼å…¥

```typescript
// æŒ‰éœ€åŠ è½½ï¼Œå‡å°åˆå§‹åŒ…ä½“ç§¯
const { submitMessageFeedback } = await import('@/service/agentChatService');
```

### 2. æ¡ä»¶æ¸²æŸ“

```typescript
// åªåœ¨éœ€è¦æ—¶æ¸²æŸ“ç»„ä»¶
{config?.speech_to_text?.enabled && <VoiceInput />}
{config?.file_upload?.enabled && <FileUpload />}
{config?.text_to_speech?.enabled && <TTSButton />}
```

### 3. çŠ¶æ€ç®¡ç†ä¼˜åŒ–

```typescript
// ä½¿ç”¨ useGetState è·å–æœ€æ–°çŠ¶æ€
const [messages, setMessages, getMessages] = useGetState<AgentMessage[]>([]);

// ä½¿ç”¨ immer ä¸å¯å˜æ›´æ–°
setMessages(produce(getMessages(), (draft) => {
  draft[idx] = { ...updatedMessage };
}));
```

---

## ğŸ¯ ä¸ Dify å¯¹æ¯”

| åŠŸèƒ½               | Dify                  | æœ¬ç³»ç»Ÿ                | çŠ¶æ€    |
| ------------------ | --------------------- | --------------------- | ------- |
| **æ ¸å¿ƒå¯¹è¯** | âœ… å®Œæ•´               | âœ… å®Œæ•´               | âœ…      |
| **ç”¨æˆ·è¾“å…¥** | âœ… è¡¨å• + è¯­éŸ³ + æ–‡ä»¶ | âœ… è¡¨å• + è¯­éŸ³ + æ–‡ä»¶ | âœ…      |
| **AI è¾“å‡º**  | âœ… TTS + å¼•ç”¨         | âœ… TTS (å¼•ç”¨å¾…å®ç°)   | ğŸŸ¡      |
| **äº¤äº’å¢å¼º** | âœ… å»ºè®®é—®é¢˜ + åé¦ˆ    | âœ… å»ºè®®é—®é¢˜ + åé¦ˆ    | âœ…      |
| **å†…å®¹å±•ç¤º** | âœ… æµå¼ Markdown      | âœ… æµå¼ Markdown      | âœ…      |
| **åœæ­¢ç”Ÿæˆ** | âœ… å®¢æˆ·ç«¯             | âœ… åŒé‡æœºåˆ¶           | ğŸ‰ æ›´å¥½ |
| **å¯¹è¯ç®¡ç†** | âœ… å®Œæ•´               | âœ… å®Œæ•´               | âœ…      |

**æœ¬ç³»ç»Ÿä¼˜åŠ¿**:

- ğŸ‰ åŒé‡åœæ­¢æœºåˆ¶ï¼ˆå®¢æˆ·ç«¯ + æœåŠ¡ç«¯ï¼‰
- ğŸ‰ æ›´å¼ºçš„ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰
- ğŸ‰ æ›´ç°ä»£çš„ UI ç»„ä»¶ï¼ˆshadcn/uiï¼‰
- ğŸ‰ æ›´å¹²å‡€çš„ä»£ç ç»“æ„

---

## ğŸ”® æœªæ¥æ‰©å±•

### ä½ä¼˜å…ˆçº§åŠŸèƒ½ï¼ˆå¯é€‰å®ç°ï¼‰

1. **å¼•ç”¨/å¼•è¯** - æ˜¾ç¤ºçŸ¥è¯†åº“æ£€ç´¢ç»“æœ
2. **æ ‡æ³¨å›å¤** - æ”¯æŒæ•°æ®æ ‡æ³¨
3. **æ•æ„Ÿè¯è§„é¿** - å†…å®¹å®‰å…¨è¿‡æ»¤
4. **æ›´å¤šç±»ä¼¼** - æ™ºèƒ½æ¨è

### ä¼˜åŒ–å»ºè®®

1. **æ€§èƒ½ä¼˜åŒ–**

   - éŸ³é¢‘æµå¼æ’­æ”¾
   - å›¾ç‰‡æ‡’åŠ è½½
   - ç»„ä»¶ä»£ç åˆ†å‰²
2. **ç”¨æˆ·ä½“éªŒ**

   - æ‹–æ‹½æ–‡ä»¶ä¸Šä¼ 
   - è¯­éŸ³è¾“å…¥å®æ—¶è½¬æ–‡å­—
   - è¡¨å•è‡ªåŠ¨ä¿å­˜
3. **æµ‹è¯•è¦†ç›–**

   - å•å…ƒæµ‹è¯•
   - é›†æˆæµ‹è¯•
   - E2E æµ‹è¯•

---

**å®Œæˆæ—¥æœŸ**: 2025-01-03
**å¼€å‘è€…**: AI Assistant
**çŠ¶æ€**: âœ… å®Œæ•´å®ç°ï¼Œä»£ç å¹²å‡€æ•´æ´ï¼Œæ˜“ç»´æŠ¤
**åŠŸèƒ½å®Œæˆåº¦**: 95% (æ ¸å¿ƒåŠŸèƒ½ 100%ï¼Œé«˜çº§åŠŸèƒ½å¾…å®ç°)
