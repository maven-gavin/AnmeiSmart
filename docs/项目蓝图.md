# 系统总体设计蓝图

## 1. 系统定位

本项目采用双系统架构设计，通过分工协作实现完整的AI驱动医美售后服务解决方案：

### 1.1 AnmeiSmart（安美智享）

专为医美机构定制的AI智能售后服务平台，聚焦售后服务全流程，提升客户满意度和服务效率。

### 1.2 SmartBrain（智能大脑）

大模型管理、智能体创建、知识库管理平台，为AnmeiSmart提供AI能力支撑。

### 1.3 数字人（Digital Human）

系统间协调的核心概念和实现载体，配置多智能体能力，协调AnmeiSmart与SmartBrain的沟通。

## 2. 技术架构

### 2.1 架构图

### 2.2 技术选型

#### AnmeiSmart系统

- **前端**：React 19.0.0/Next.js 15、TypeScript 6、tailwindcss/shadcn UI
- **后端**：Python 3.12、FastAPI、uvicorn、Pydantic
- **数据库**：PostgreSQL（结构化数据）、MongoDB（非结构化）
- **数字人服务**：多模态交互、智能体能力配置、个性化服务

#### SmartBrain系统

- **AI平台**：大模型管理、智能体编排、知识库管理
- **模型服务**：智能客服Agent、症状识别模型、知识图谱、图像识别API
- **能力调度**：负载均衡、资源分配、性能优化、故障恢复

#### 外部系统

- **CRM对接**：客户关系管理
- **第三方AI服务**：语音识别、图像处理、自然语言处理

### 2.3 数据流

#### 双系统协作流程

- **客户咨询**→AnmeiSmart前端→数字人服务→SmartBrain AI能力→智能体响应→数字人协调→AnmeiSmart前端
- **症状数据/服务记录**→AnmeiSmart收集→SmartBrain AI分析→预警/建议/满意度评估→AnmeiSmart服务优化

#### 数字人协调机制

- **智能体能力配置**：数字人从SmartBrain获取可用智能体能力
- **服务策略执行**：数字人根据客户画像和场景选择合适的智能体组合
- **个性化服务**：数字人基于历史交互数据优化服务体验

### 2.4 目录结构

#### AnmeiSmart系统架构

- **前端架构**：
  - web/src/app/ - 页面路由与页面组件
  - web/src/components/ - 共享组件
  - web/src/service/ - API客户端与服务
  - web/src/contexts/ - 全局状态
  - web/src/types/ - 类型定义
- **后端架构**：
  - api/app/ - 核心应用代码
  - api/app/models/ - 数据模型
  - api/app/services/ - 业务服务
  - api/app/api/ - API接口
  - api/app/core/ - 核心功能（加密、安全等）

#### SmartBrain系统架构

- **AI平台架构**：
  - models/ - 大模型管理
  - agents/ - 智能体管理
  - knowledge/ - 知识库管理
  - scheduler/ - AI能力调度
  - api/ - AI能力接口

## 3. 系统设计

### 3.1 数据库设计

#### AnmeiSmart系统数据库

- **用户表（User）**：id, name, role, contact, ...
- **客户档案（CustomerProfile）**：id, user_id, treatment_history, recovery_status, ...
- **服务记录（ServiceRecord）**：id, customer_id, service_type, content, satisfaction_score, timestamp, ...
- **症状记录（SymptomRecord）**：id, customer_id, symptom_type, description, images, severity, timestamp, ...
- **服务质量指标（ServiceMetrics）**：id, response_time, resolution_rate, satisfaction_avg, date, ...
- **角色表（Role）**：id, name, description, permissions, ...
- **数字人配置（DigitalHumans,DigitalHumanAgentConfigs）**：数字人定义，数字人与智能体配置

#### SmartBrain系统数据库

- **大模型表（AIModel）**：id, name, version, type, status, performance_metrics, ...
- **智能体表（Agent）**：id, name, model_id, capabilities, configuration, status, ...
- **知识库表（KnowledgeBase）**：id, name, type, content, version, update_time, ...
- **能力调度表（CapabilityScheduler）**：id, agent_id, request_id, status, response_time, ...

### 3.2 UI设计

#### AnmeiSmart系统界面

- **客户端**：术后咨询界面、症状上传、恢复进度查看、满意度评价、复购预约
- **售后客服端**：智能客服工作台、问题处理流程、客户沟通记录、满意度跟踪
- **医生端**：专业指导界面、异常情况处理、复诊建议、医疗决策支持
- **数字人管理端**：数字人配置界面、智能体能力分配、服务策略制定、个性化服务设计
- **运营端**：服务质量大屏、客户满意度分析、复购率统计、服务流程优化

#### SmartBrain系统界面

- **AI平台管理端**：大模型管理界面、智能体创建工具、知识库维护、AI能力调度
- **系统集成端**：系统配置、API管理、数据同步、监控告警

#### 数字人服务界面

- **数字人交互界面**：多模态对话、智能体能力展示、个性化服务体验
- **数字人配置界面**：形象定制、能力配置、服务策略、效果监控

### 3.3 算法设计

#### AnmeiSmart系统算法

- **智能客服**：基于RAG的问答系统+多轮对话管理+意图识别
- **症状识别**：图像识别模型+自然语言处理+异常检测算法
- **满意度预测**：基于服务记录的机器学习模型，预测客户满意度趋势
- **服务质量评估**：多维度指标分析+实时监控+预警系统

#### SmartBrain系统算法

- **大模型管理**：模型版本控制、性能监控、A/B测试、自动部署
- **智能体编排**：能力组合优化、负载均衡、故障转移
- **知识库管理**：知识抽取、结构化处理、质量评估、自动更新
- **AI能力调度**：资源分配优化、性能预测、成本控制

#### 数字人协调算法

- **智能体能力配置**：基于场景的智能体选择算法
- **个性化服务**：客户画像分析、服务偏好学习、体验优化
- **多模态交互**：语音、图像、文本的统一处理和理解

## 4. 非功能需求

### 4.1 性能要求

- **AnmeiSmart系统**：接口响应<50ms，首屏加载<1s，支持≥1000并发用户
- **SmartBrain系统**：AI能力调用响应<200ms，模型推理<1s，支持≥100并发AI请求
- **数字人服务**：多模态交互响应<100ms，智能体切换<50ms

### 4.2 安全要求

- **数据安全**：全链路HTTPS，数据加密存储，API密钥安全管理
- **权限管理**：细粒度权限控制，角色分离，审计日志
- **系统安全**：双系统隔离，API访问控制，安全监控

### 4.3 可用性要求

- **系统可用性**：SLA≥99.9%，自动化监控与故障恢复
- **服务连续性**：智能体故障自动切换，AI能力降级处理
- **数据一致性**：双系统数据同步，事务一致性保证

### 4.4 兼容性要求

- **客户端兼容**：支持主流浏览器（Chrome/Edge/Safari）、iOS/Android移动端
- **API兼容**：RESTful API标准，版本兼容性管理
- **集成兼容**：支持第三方系统集成，标准化接口

## 5. 测试与部署

### 5.1 测试策略

- **测试类型**：单元测试、集成测试、系统测试、AI模型测试、双系统集成测试
- **测试环境**：开发环境、测试环境、预生产环境、生产环境

### 5.2 关键测试用例

#### AnmeiSmart系统测试

- **智能客服**：多轮对话、FAQ匹配、人工介入流程、响应时间测试
- **症状识别**：不同症状图片/描述，验证识别准确性和预警机制
- **服务质量监控**：响应时间、解决率、满意度统计的准确性验证
- **数字人服务**：多模态交互、智能体能力配置、个性化服务测试

#### SmartBrain系统测试

- **大模型管理**：模型部署、版本控制、性能监控、A/B测试
- **智能体创建**：智能体设计、能力配置、测试验证、发布管理
- **知识库管理**：知识录入、结构化处理、版本控制、质量评估
- **AI能力调度**：负载均衡、资源分配、性能优化、故障恢复

#### 双系统集成测试

- **系统协作**：AnmeiSmart与SmartBrain的数据交互、API调用
- **数字人协调**：智能体能力获取、服务策略执行、个性化服务
- **端到端测试**：完整业务流程测试、性能压力测试

### 5.3 部署架构

- **容器化部署**：Docker容器化、Kubernetes编排
- **CI/CD流程**：自动化构建、测试、部署、监控
- **云服务架构**：云服务器、负载均衡、自动扩缩容
- **监控告警**：系统监控、性能监控、业务监控、告警机制

## 6. 维护与展望

### 6.1 系统维护

- **AnmeiSmart系统维护**：定期安全更新、数据备份、日志监控、自动告警
- **SmartBrain系统维护**：AI模型更新、智能体优化、知识库维护、性能调优
- **数字人服务维护**：服务策略优化、智能体能力更新、用户体验改进

### 6.2 技术展望

- **AI能力扩展**：引入更先进的大模型、多模态AI能力、实时学习能力
- **数字人进化**：更智能的个性化服务、情感计算、自然交互
- **系统集成**：多机构协作、数据互通、行业标准化

### 6.3 业务展望

- **服务场景扩展**：覆盖更多医美售后服务场景、预测性维护
- **智能化升级**：全流程AI驱动、自动化决策、智能运营
- **生态建设**：开放平台、第三方集成、行业生态

---

> 本蓝图为AnmeiSmart与SmartBrain双系统架构的总体设计，配合《产品需求说明书》共同指导项目全流程。通过数字人协调机制，实现业务应用与AI能力的深度融合。
